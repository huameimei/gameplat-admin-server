<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gameplat.admin.mapper.activity.MemberRedPacketConditionDao">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.gameplat.admin.model.domain.activity.MemberRedPacketCondition">
        <id column="condition_id" property="conditionId" />
        <result column="red_packet_id" property="redPacketId" />
        <result column="top_up_money" property="topUpMoney" />
        <result column="draw_num" property="drawNum" />
        <result column="packet_min_money" property="packetMinMoney" />
        <result column="packet_max_money" property="packetMaxMoney" />
        <result column="remark" property="remark" />
        <result column="create_by" property="createBy" />
        <result column="create_time" property="createTime" />
        <result column="update_by" property="updateBy" />
        <result column="update_time" property="updateTime" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        condition_id, red_packet_id, top_up_money, draw_num, remark, create_by, create_time, update_by, update_time,packet_min_money,packet_max_money
    </sql>

    <select id="findRedPacketConditionList" resultMap="BaseResultMap">
    	SELECT <include refid="Base_Column_List"></include> from member_red_packet_condition where red_packet_id = #{redPacketId} order by top_up_money asc
    </select>

	<select id="findRedPacketConditionDescList" resultMap="BaseResultMap">
		SELECT <include refid="Base_Column_List"></include> from member_red_packet_condition where red_packet_id = #{redPacketId} order by top_up_money DESC
	</select>

	<!-- 新增红包雨条件 -->
	<insert id="saveRedPacketCondition">
		INSERT INTO member_red_packet_condition(
		condition_id,
		red_packet_id,
		top_up_money,
		draw_num,
		packet_min_money,
		packet_max_money,
		create_by,
		create_time
		)
		VALUES
		<foreach collection="list" item="obj" separator="," >
		(
		<if test="obj.conditionId != null">#{obj.conditionId},</if>
		<if test="obj.redPacketId != null">#{obj.redPacketId},</if>
		<if test="obj.topUpMoney != null">#{obj.topUpMoney},</if>
		<if test="obj.drawNum != null">#{obj.drawNum},</if>
		<if test="obj.packetMinMoney != null">#{obj.packetMinMoney},</if>
		<if test="obj.packetMaxMoney != null">#{obj.packetMaxMoney},</if>
		<if test="obj.createBy != null">#{obj.createBy},</if>
		<if test="obj.createTime != null">#{obj.createTime}</if>
		)
		</foreach>
	</insert>

	<!-- 修改红包雨条件 -->
	<update id="updateRedPacketCondition">
	  <foreach collection="list" item="item" index="index" open="" close="" separator=";">
			UPDATE member_red_packet_condition
			<set>
				<if test="item.redPacketId != null">red_packet_id = #{item.redPacketId},</if>
				<if test="item.topUpMoney != null">top_up_money = #{item.topUpMoney},</if>
				<if test="item.drawNum != null">draw_num = #{item.drawNum},</if>
				<if test="item.packetMinMoney != null">packet_min_money = #{item.packetMinMoney},</if>
				<if test="item.packetMaxMoney != null">packet_max_money = #{item.packetMaxMoney},</if>
				<if test="item.updateBy != null">update_by = #{item.updateBy},</if>
				update_time = sysdate()
			</set>
			WHERE condition_id = #{item.conditionId}
		</foreach>
	</update>

	<!-- 删除红包雨条件 -->
	<delete id="deleteRedPacketCondition">
		DELETE from member_red_packet_condition where condition_id in
		<foreach collection="array" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
	</delete>

	<delete id="deleteRedPacketId">
		DELETE from member_red_packet_condition where red_packet_id = #{redPacketId}
	</delete>
</mapper>
